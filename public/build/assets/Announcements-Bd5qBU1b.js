import{r as x,j as e,L as G,S as b}from"./app-DpTxKQAf.js";import{A as w,a as A}from"./alert-B1caCfZ1.js";import{B as C}from"./badge-BHaFTTI2.js";import{B as u}from"./button-EmHOAWCh.js";import{C as S,a as T,b as R,c as U}from"./card-DrGcUUNM.js";import{C as E}from"./checkbox-DJvJ0Xa_.js";import{D as P,a as X,b as M,c as O,d as B}from"./dialog-DQZD4J_d.js";import{I as J}from"./input-6b6wo28k.js";import{L as h}from"./label-DQBlYoye.js";import{T as K}from"./textarea-CyH7-6cF.js";import Q from"./Header-CPfrUZWL.js";import F from"./Sidebar-CiCbE-lx.js";import{P as L,S as V}from"./square-pen-D83PiznQ.js";import{C as W}from"./circle-check-big-D4t3uExM.js";import{C as Y}from"./circle-x-dWB1UB7q.js";import{B as Z}from"./bell-0vn567Sl.js";import{T as ee}from"./trash-2-DO9-pkmW.js";import"./Combination-DQHq3tOk.js";import"./index-BtH7JKO-.js";import"./index-CtX3QR9Y.js";import"./createLucideIcon-uFufCLSQ.js";import"./dropdown-menu-CKSOrcSz.js";import"./x-Cw8E9nhQ.js";import"./index-CtBsO7PD.js";import"./user-wZ1yEFEq.js";import"./log-out-BUIlX1OT.js";import"./chart-column-ca2rcyDB.js";import"./users-cUYpqWpM.js";import"./calendar--REYLK8D.js";import"./qr-code-Dwz7AgoG.js";import"./file-text-Bexp6W_O.js";const $=({onSubmit:g,formData:a,setFormData:n,errors:l,puroks:j,editingAnnouncement:f,onCancel:i})=>{const _=s=>{a.target_all_puroks||n(r=>{const c=r.target_puroks.includes(s)?r.target_puroks.filter(d=>d!==s):[...r.target_puroks,s];return c.length>3?r:{...r,target_puroks:c}})},o=s=>{n(r=>({...r,target_all_puroks:s,target_puroks:s?[]:r.target_puroks}))};return e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"title",children:"Title"}),e.jsx(J,{id:"title",value:a.title,onChange:s=>n(r=>({...r,title:s.target.value})),placeholder:"Enter announcement title",className:l.title?"border-red-500":""}),l.title&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:l.title})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"content",children:"Content"}),e.jsx(K,{id:"content",value:a.content,onChange:s=>n(r=>({...r,content:s.target.value})),placeholder:"Enter announcement content",rows:4,className:l.content?"border-red-500":""}),l.content&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:l.content})]}),e.jsxs("div",{children:[e.jsx(h,{children:"Target Audience"}),e.jsxs("div",{className:"mt-2 space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{id:"target_all_puroks",checked:a.target_all_puroks,onCheckedChange:o}),e.jsx(h,{htmlFor:"target_all_puroks",children:"All Puroks"})]}),!a.target_all_puroks&&e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 text-sm text-gray-600",children:"Select specific puroks (up to 3):"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:j.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{id:`purok_${s.id}`,checked:a.target_puroks.includes(s.id),onCheckedChange:()=>_(s.id),disabled:!a.target_puroks.includes(s.id)&&a.target_puroks.length>=3}),e.jsx(h,{htmlFor:`purok_${s.id}`,children:s.name})]},s.id))}),a.target_puroks.length>=3&&e.jsx("p",{className:"mt-1 text-sm text-amber-600",children:"Maximum of 3 puroks can be selected"})]})]}),l.target_puroks&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:l.target_puroks})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(u,{type:"button",variant:"outline",onClick:i,children:"Cancel"}),e.jsxs(u,{type:"submit",children:[f?"Update":"Create"," Announcement"]})]})]})};function Me({announcements:g,puroks:a,flash:n}){const[l,j]=x.useState(!1),[f,i]=x.useState(!1),[_,o]=x.useState(!1),[s,r]=x.useState(null),[c,d]=x.useState({title:"",content:"",target_puroks:[],target_all_puroks:!1}),[y,k]=x.useState({}),N=()=>{d({title:"",content:"",target_puroks:[],target_all_puroks:!1}),k({})},z=t=>{t.preventDefault(),b.post("/secretary/announcements",c,{onSuccess:()=>{i(!1),N()},onError:p=>k(p)})},H=t=>{t.preventDefault(),s&&b.put(`/secretary/announcements/${s.id}`,c,{onSuccess:()=>{o(!1),r(null),N()},onError:p=>k(p)})},D=t=>{confirm("Are you sure you want to delete this announcement?")&&b.delete(`/secretary/announcements/${t}`)},I=t=>{r(t),d({title:t.title,content:t.content,target_puroks:t.target_puroks||[],target_all_puroks:t.target_all_puroks}),o(!0)},q=t=>{if(t.target_all_puroks)return e.jsx(C,{variant:"secondary",children:"All Puroks"});if(t.target_puroks&&t.target_puroks.length>0){const p=a.filter(m=>{var v;return(v=t.target_puroks)==null?void 0:v.includes(m.id)}).map(m=>m.name);return e.jsx("div",{className:"flex flex-wrap gap-1",children:p.map(m=>e.jsx(C,{variant:"outline",children:m},m))})}return e.jsx(C,{variant:"destructive",children:"No Target"})};return e.jsxs(e.Fragment,{children:[e.jsx(G,{title:"Announcements - Secretary"}),e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx("div",{className:"hidden lg:block",children:e.jsx(F,{currentPage:"secretary.announcements"})}),l&&e.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>j(!1)}),e.jsx("div",{className:"absolute top-0 left-0 h-full",children:e.jsx(F,{currentPage:"secretary.announcements"})})]}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx(Q,{onMobileMenuToggle:()=>j(!l)}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:e.jsxs("div",{className:"mx-auto max-w-7xl space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Announcements"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Manage community announcements"})]}),e.jsxs(P,{open:f,onOpenChange:i,children:[e.jsx(X,{asChild:!0,children:e.jsxs(u,{onClick:()=>i(!0),children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"Create Announcement"]})}),e.jsxs(M,{className:"max-w-2xl",children:[e.jsx(O,{children:e.jsx(B,{children:"Create New Announcement"})}),e.jsx($,{onSubmit:z,formData:c,setFormData:d,errors:y,puroks:a,editingAnnouncement:s,onCancel:()=>{i(!1),N()}})]})]})]}),(n==null?void 0:n.success)&&e.jsxs(w,{className:"border-green-200 bg-green-50",children:[e.jsx(W,{className:"h-4 w-4 text-green-600"}),e.jsx(A,{className:"text-green-800",children:n.success})]}),(n==null?void 0:n.error)&&e.jsxs(w,{className:"border-red-200 bg-red-50",children:[e.jsx(Y,{className:"h-4 w-4 text-red-600"}),e.jsx(A,{className:"text-red-800",children:n.error})]}),e.jsx("div",{className:"grid gap-6",children:g.length===0?e.jsx(S,{children:e.jsxs(T,{className:"p-12 text-center",children:[e.jsx(Z,{className:"mx-auto mb-4 h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mb-2 text-lg font-medium text-gray-900",children:"No announcements yet"}),e.jsx("p",{className:"mb-4 text-gray-500",children:"Get started by creating your first announcement."}),e.jsxs(u,{onClick:()=>i(!0),children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"Create Announcement"]})]})}):g.map(t=>e.jsxs(S,{children:[e.jsxs(R,{className:"flex flex-row items-start justify-between space-y-0 pb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(U,{className:"text-xl",children:t.title}),e.jsx("div",{className:"mt-2 flex items-center gap-2",children:e.jsxs("span",{className:"text-sm text-gray-500",children:["by ",t.created_by," â€¢ ",t.created_at]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{size:"sm",variant:"outline",onClick:()=>I(t),children:e.jsx(V,{className:"h-4 w-4"})}),e.jsx(u,{size:"sm",variant:"outline",onClick:()=>D(t.id),className:"text-red-600 hover:text-red-700",children:e.jsx(ee,{className:"h-4 w-4"})})]})]}),e.jsxs(T,{children:[e.jsx("p",{className:"mb-3 whitespace-pre-wrap text-gray-700",children:t.content}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Target: "}),q(t)]})})]})]},t.id))}),e.jsx(P,{open:_,onOpenChange:o,children:e.jsxs(M,{className:"max-w-2xl",children:[e.jsx(O,{children:e.jsx(B,{children:"Edit Announcement"})}),e.jsx($,{onSubmit:H,formData:c,setFormData:d,errors:y,puroks:a,editingAnnouncement:s,onCancel:()=>{o(!1),r(null),N()}})]})})]})})]})]})]})}export{Me as default};
