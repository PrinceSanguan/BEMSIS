import{K as A,r as m,j as e,L as M,S as D}from"./app-DpTxKQAf.js";import{A as f,a as u}from"./alert-B1caCfZ1.js";import{B as _}from"./badge-BHaFTTI2.js";import{B as v}from"./button-EmHOAWCh.js";import{C as i,b as c,c as n,a as d}from"./card-DrGcUUNM.js";import{D as q,b as F,c as E,d as U}from"./dialog-DQZD4J_d.js";import B from"./Header-CPfrUZWL.js";import y from"./Sidebar-CiCbE-lx.js";import{A as P}from"./arrow-left-D9eXvPLf.js";import{C as T}from"./circle-check-big-D4t3uExM.js";import{C as L}from"./circle-x-dWB1UB7q.js";import{C as z}from"./clock-BJoP2_AG.js";import{M as b}from"./map-pin-Cv-ZHoQ3.js";import{U as C}from"./users-cUYpqWpM.js";import{M as H}from"./mail-BETHgdgr.js";import{P as I}from"./phone-BPWRGX_K.js";import{Q as O}from"./qr-code-Dwz7AgoG.js";import"./Combination-DQHq3tOk.js";import"./index-BtH7JKO-.js";import"./dropdown-menu-CKSOrcSz.js";import"./createLucideIcon-uFufCLSQ.js";import"./x-Cw8E9nhQ.js";import"./index-CtBsO7PD.js";import"./user-wZ1yEFEq.js";import"./log-out-BUIlX1OT.js";import"./chart-column-ca2rcyDB.js";import"./calendar--REYLK8D.js";import"./file-text-Bexp6W_O.js";function ue({event:r,attendees:a}){const{flash:t}=A().props,[h,j]=m.useState(!1),[l,w]=m.useState(null),[R,g]=m.useState(!1),[p,k]=m.useState(null),o=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),Q=s=>{if(!s.qr_code){alert("No QR code assigned to this attendee");return}w(s);const S="https://api.qrserver.com/v1/create-qr-code/?"+new URLSearchParams({size:"200x200",data:s.qr_code,color:"000000",bgcolor:"FFFFFF",ecc:"M",margin:"10"});k(S),g(!0)},N=a.filter(s=>s.scanned).length,x=a.length>0?Math.round(N/a.length*100):0;return e.jsxs(e.Fragment,{children:[e.jsx(M,{title:`Attendees - ${r.title}`}),e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx("div",{className:"hidden lg:block",children:e.jsx(y,{currentPage:"secretary.events"})}),h&&e.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>j(!1)}),e.jsx("div",{className:"absolute top-0 left-0 h-full",children:e.jsx(y,{currentPage:"secretary.events"})})]}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx(B,{onMobileMenuToggle:()=>j(!h)}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:e.jsxs("div",{className:"mx-auto max-w-7xl space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(v,{variant:"outline",onClick:()=>D.get("/secretary/events"),className:"shrink-0",children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Back to Events"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r.title}),e.jsx("p",{className:"text-gray-600",children:"Event Attendees"})]})]}),(t==null?void 0:t.success)&&e.jsxs(f,{className:"border-green-200 bg-green-50",children:[e.jsx(T,{className:"h-4 w-4 text-green-600"}),e.jsx(u,{className:"text-green-800",children:t.success})]}),(t==null?void 0:t.error)&&e.jsxs(f,{className:"border-red-200 bg-red-50",children:[e.jsx(L,{className:"h-4 w-4 text-red-600"}),e.jsx(u,{className:"text-red-800",children:t.error})]}),e.jsxs(i,{children:[e.jsx(c,{children:e.jsx(n,{children:"Event Information"})}),e.jsxs(d,{children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:[o(r.start_date),r.end_date&&` - ${o(r.end_date)}`]})]}),r.purok&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:r.purok.name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:[a.length," registered"]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("p",{className:"text-sm text-gray-600",children:r.description})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs(i,{children:[e.jsx(c,{className:"pb-2",children:e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Total Registered"})}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold",children:a.length})})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-2",children:e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Attended"})}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:N})})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-2",children:e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Attendance Rate"})}),e.jsx(d,{children:e.jsxs("div",{className:`text-2xl font-bold ${x>=80?"text-green-600":x>=60?"text-yellow-600":"text-red-600"}`,children:[x,"%"]})})]})]}),e.jsxs(i,{children:[e.jsx(c,{children:e.jsxs(n,{children:["Attendees (",a.length,")"]})}),e.jsx(d,{children:a.length===0?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(C,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No attendees"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"No one has registered for this event yet."})]}):e.jsx("div",{className:"space-y-4",children:a.map(s=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:s.user.name}),e.jsx(_,{className:s.scanned?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:s.scanned?"Attended":"Registered"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm text-gray-600 md:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{children:s.user.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:s.user.phone})]}),s.user.purok&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4"}),e.jsx("span",{children:s.user.purok.name})]})]}),s.scanned&&s.scanned_at&&e.jsxs("div",{className:"mt-2 text-xs text-green-600",children:["Attended: ",o(s.scanned_at)]})]}),e.jsx("div",{className:"ml-4",children:s.qr_code&&e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>Q(s),children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),"View QR"]})})]},s.id))})})]})]})})]})]}),e.jsx(q,{open:R,onOpenChange:g,children:e.jsxs(F,{className:"max-w-md",children:[e.jsx(E,{children:e.jsxs(U,{children:["QR Code for ",l==null?void 0:l.user.name]})}),e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[p&&e.jsx("div",{className:"rounded-lg border bg-white p-4",children:e.jsx("img",{src:p,alt:"QR Code",className:"h-48 w-48",onError:s=>{console.error("Failed to load QR code image"),s.currentTarget.style.display="none"}})}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["QR Code: ",l==null?void 0:l.qr_code]}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"This QR code is used for attendance verification."})]})]})]})})]})}export{ue as default};
