import{K as q,r as u,j as e,L as Q,S as A}from"./app-D3T1n4bI.js";import{A as z,a as R}from"./alert-RtdgKugQ.js";import{B as y}from"./badge-r4QWlGEb.js";import{B as n}from"./button-f6i-Hsu5.js";import{C as $,b as X,c as Z,d as I,a as L}from"./card-XNqk8LyP.js";import{D as ee,b as se,c as te,d as ae,e as re}from"./dialog-fboHmZmb.js";import ie from"./Header-CyilP6fj.js";import O from"./Sidebar-DGJ2hna2.js";import{G as le,L as ne,C as ce,a as de}from"./list-8cQpcUQ6.js";import{C as oe}from"./calendar-DbRQwxhL.js";import{C as me}from"./clock-ZOi8I8CW.js";import{M as xe}from"./map-pin-Dif7QdtW.js";import{U as he}from"./users-eciyp-rC.js";import{A as ge}from"./award-us1Ch1UW.js";import"./Combination-Cjm0Iuft.js";import"./index-4zbVwmYN.js";import"./dropdown-menu-B3k3E-lp.js";import"./createLucideIcon-BpmfQe8N.js";import"./x-Pu1PIWjA.js";import"./index-CtBsO7PD.js";import"./house-fL4Wfdlk.js";import"./user-DrVmvJgf.js";import"./log-out-Bu8ebVwl.js";import"./chart-column-Dj_6RZIY.js";import"./qr-code-iSFG00TU.js";import"./bell-B1RPYDky.js";import"./settings-A_dL-YCl.js";function Ye({events:N}){const{flash:c}=q().props,[D,C]=u.useState(!1),[a,m]=u.useState(null),[d,p]=u.useState(null),[f,M]=u.useState("calendar"),[S,k]=u.useState(new Date),x=S.getMonth(),h=S.getFullYear(),F=new Date(h,x,1),P=new Date(h,x+1,0),U=F.getDay(),v=P.getDate(),b=U,B=Math.ceil((v+b)/7)*7,Y=["January","February","March","April","May","June","July","August","September","October","November","December"],H=u.useMemo(()=>{const s={};return N.forEach(o=>{const i=new Date(o.start_date),t=`${i.getFullYear()}-${i.getMonth()}-${i.getDate()}`;s[t]||(s[t]=[]),s[t].push(o)}),s},[N]),w=s=>{const o=`${s.getFullYear()}-${s.getMonth()}-${s.getDate()}`;return H[o]||[]},E=s=>{p(s),A.post(route("resident.events.register",s),{},{onSuccess:()=>{p(null)},onError:()=>{p(null)}})},_=s=>{p(s),A.delete(route("resident.events.unregister",s),{onSuccess:()=>{p(null)},onError:()=>{p(null)}})},T=s=>{k(o=>{const i=new Date(o);return s==="prev"?i.setMonth(i.getMonth()-1):i.setMonth(i.getMonth()+1),i})},J=()=>{k(new Date)},K=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),V=s=>new Date(s).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),G=s=>new Date(s).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),W=()=>{const s=[],o=new Date(h,x-1,0);for(let t=b-1;t>=0;t--){const g=new Date(h,x-1,o.getDate()-t),r=w(g);s.push(e.jsxs("div",{className:"min-h-12 border border-gray-200 bg-gray-50 p-1 opacity-40 sm:min-h-16 sm:p-2 lg:min-h-24",children:[e.jsx("div",{className:"text-sm text-gray-500",children:g.getDate()}),r.length>0&&e.jsxs("div",{className:"mt-1 space-y-1",children:[r.slice(0,2).map(l=>e.jsx("div",{className:"cursor-pointer truncate rounded bg-gray-200 px-1 py-0.5 text-xs text-gray-600",onClick:()=>m(l),children:l.title},l.id)),r.length>2&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",r.length-2," more"]})]})]},`prev-${t}`))}for(let t=1;t<=v;t++){const g=new Date(h,x,t),r=w(g),l=new Date().toDateString()===g.toDateString();s.push(e.jsxs("div",{className:`min-h-12 border border-gray-200 bg-white p-1 sm:min-h-16 sm:p-2 lg:min-h-24 ${l?"border-blue-300 bg-blue-50":""}`,children:[e.jsx("div",{className:`text-sm font-medium ${l?"text-blue-600":"text-gray-900"}`,children:t}),r.length>0&&e.jsxs("div",{className:"mt-1 space-y-1",children:[r.slice(0,2).map(j=>e.jsx("div",{className:`cursor-pointer truncate rounded px-1 py-0.5 text-xs font-medium ${j.user_registered?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,onClick:()=>m(j),title:j.title,children:j.title},j.id)),r.length>2&&e.jsxs("div",{className:"cursor-pointer text-xs text-gray-500 hover:text-gray-700",children:["+",r.length-2," more"]})]})]},t))}const i=B-v-b;for(let t=1;t<=i;t++){const g=new Date(h,x+1,t),r=w(g);s.push(e.jsxs("div",{className:"min-h-12 border border-gray-200 bg-gray-50 p-1 opacity-40 sm:min-h-16 sm:p-2 lg:min-h-24",children:[e.jsx("div",{className:"text-sm text-gray-500",children:t}),r.length>0&&e.jsxs("div",{className:"mt-1 space-y-1",children:[r.slice(0,2).map(l=>e.jsx("div",{className:"cursor-pointer truncate rounded bg-gray-200 px-1 py-0.5 text-xs text-gray-600",onClick:()=>m(l),children:l.title},l.id)),r.length>2&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",r.length-2," more"]})]})]},`next-${t}`))}return s};return e.jsxs(e.Fragment,{children:[e.jsx(Q,{title:"Community Events"}),e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx("div",{className:"hidden lg:block",children:e.jsx(O,{currentPage:"resident.events"})}),D&&e.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>C(!1)}),e.jsx("div",{className:"absolute top-0 left-0 h-full",children:e.jsx(O,{currentPage:"resident.events"})})]}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx(ie,{onMobileMenuToggle:()=>C(!D)}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 lg:p-6",children:e.jsxs("div",{className:"mx-auto max-w-7xl space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Community Events"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Discover and register for upcoming community events"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center rounded-lg border bg-white p-1",children:[e.jsxs(n,{variant:f==="calendar"?"default":"ghost",size:"sm",onClick:()=>M("calendar"),className:"h-8 px-3",children:[e.jsx(le,{className:"mr-1 h-4 w-4"}),"Calendar"]}),e.jsxs(n,{variant:f==="list"?"default":"ghost",size:"sm",onClick:()=>M("list"),className:"h-8 px-3",children:[e.jsx(ne,{className:"mr-1 h-4 w-4"}),"List"]})]})})]}),(c==null?void 0:c.success)&&e.jsx(z,{className:"border-green-200 bg-green-50",children:e.jsx(R,{className:"text-green-800",children:c.success})}),(c==null?void 0:c.error)&&e.jsx(z,{className:"border-red-200 bg-red-50",children:e.jsx(R,{className:"text-red-800",children:c.error})}),f==="calendar"&&e.jsxs($,{children:[e.jsx(X,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Z,{className:"text-2xl",children:[Y[x]," ",h]}),e.jsx(I,{children:"View events in calendar format"})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-2",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:J,className:"w-full sm:w-auto",children:"Today"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>T("prev"),className:"flex-1 sm:flex-none",children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-1 sm:hidden",children:"Prev"})]}),e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>T("next"),className:"flex-1 sm:flex-none",children:[e.jsx(de,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-1 sm:hidden",children:"Next"})]})]})]})]})}),e.jsxs(L,{children:[e.jsx("div",{children:e.jsx("div",{className:"mb-2 grid grid-cols-7 gap-px",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(s=>e.jsxs("div",{className:"bg-gray-100 p-2 text-center text-sm font-medium text-gray-600",children:[e.jsx("span",{className:"hidden sm:inline",children:s}),e.jsx("span",{className:"sm:hidden",children:s.slice(0,1)})]},s))})}),e.jsx("div",{children:e.jsx("div",{className:"grid grid-cols-7 gap-px overflow-hidden rounded-lg border border-gray-200",children:W()})})]})]}),f==="list"&&e.jsx($,{children:e.jsx(L,{className:"p-6",children:N.length===0?e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(oe,{className:"mx-auto mb-4 h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mb-2 text-lg font-medium text-gray-900",children:"No events available"}),e.jsx("p",{className:"text-gray-600",children:"There are no upcoming events at this time."})]}):e.jsx("div",{className:"space-y-4",children:N.map(s=>e.jsx("div",{className:"rounded-lg border border-gray-200 p-6 transition-shadow hover:shadow-md",children:e.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.title}),s.user_registered&&e.jsx(y,{className:"bg-blue-100 text-blue-800",children:"Registered"}),s.has_certificate&&e.jsx(y,{variant:"outline",children:"Certificate Available"})]}),e.jsx("p",{className:"line-clamp-2 text-gray-600",children:s.description}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 text-sm text-gray-600 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4"}),e.jsx("span",{children:G(s.start_date)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsx("span",{children:s.purok_names||"All Residents"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.current_attendees," attendees"]})]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Organized by: ",s.creator.name]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>m(s),children:"View Details"}),s.user_registered?e.jsx(n,{size:"sm",variant:"destructive",onClick:()=>_(s.id),disabled:d===s.id,children:d===s.id?"Processing...":"Unregister"}):e.jsx(n,{size:"sm",onClick:()=>E(s.id),disabled:d===s.id,children:d===s.id?"Registering...":"Register"})]})]})},s.id))})})})]})})]})]}),a&&e.jsx(ee,{open:!!a,onOpenChange:()=>m(null),children:e.jsxs(se,{className:"max-w-2xl",children:[e.jsxs(te,{children:[e.jsx(ae,{children:a.title}),e.jsx(re,{children:"Event details and information"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.user_registered&&e.jsx(y,{className:"bg-blue-100 text-blue-800",children:"Registered"}),a.has_certificate&&e.jsxs(y,{variant:"outline",className:"text-amber-600",children:[e.jsx(ge,{className:"mr-1 h-3 w-3"}),"Certificate Available"]})]}),e.jsx("p",{className:"text-gray-600",children:a.description}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Date & Time"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[K(a.start_date)," at ",V(a.start_date)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Location"}),e.jsx("p",{className:"text-sm text-gray-600",children:a.purok_names||"All Residents"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Organizer"}),e.jsx("p",{className:"text-sm text-gray-600",children:a.creator.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Attendees"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[a.current_attendees," registered"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 pt-4",children:a.user_registered?e.jsx(n,{variant:"destructive",onClick:()=>{_(a.id),m(null)},disabled:d===a.id,children:d===a.id?"Processing...":"Unregister from Event"}):e.jsx(n,{onClick:()=>{E(a.id),m(null)},disabled:d===a.id,children:d===a.id?"Registering...":"Register for Event"})})]})]})})]})}export{Ye as default};
