import{K as P,r as u,m as T,j as e,L as A,S as k}from"./app-CuuzbVEq.js";import{A as C,a as y}from"./alert-BB5lBvb-.js";import{B as o}from"./button-Bz73IOL-.js";import{C as U,b as R,c as L,a as B}from"./card-DPuYBbvn.js";import{C as j}from"./checkbox-CBCxgXEz.js";import{I as x}from"./input-BYxuuBn5.js";import{L as l}from"./label-BEJW7mG7.js";import{T as O}from"./textarea-B9t2HIK8.js";import $ from"./Header-BNvsmSmt.js";import w from"./Sidebar-Bz3-Sa5u.js";import{A as M}from"./arrow-left-CyYlrZ9E.js";import{X as q}from"./x-rr-rPsU_.js";import{U as z}from"./upload-jmpLuxZ8.js";import"./index-BcY7FhV-.js";import"./Combination-DNsBpELT.js";import"./index-3k_GYHV7.js";import"./createLucideIcon-Lam23By3.js";import"./dropdown-menu-Dzlu6hig.js";import"./index-CtBsO7PD.js";import"./user-DRk6pA1v.js";import"./log-out-j-dQhA56.js";import"./chart-column-CRYJK-8M.js";import"./calendar-CB1oa5u-.js";function xe({event:i,puroks:E}){const{flash:n}=P().props,[_,f]=u.useState(!1),[h,v]=u.useState(i.image_path?`/storage/${i.image_path}`:null),m=u.useRef(null),{data:s,setData:d,processing:g,errors:a}=T({title:i.title,description:i.description,start_date:i.start_date?new Date(i.start_date).toISOString().slice(0,16):"",end_date:i.end_date?new Date(i.end_date).toISOString().slice(0,16):"",purok_ids:i.purok_ids||[],has_certificate:i.has_certificate,target_all_residents:i.target_all_residents,image:null}),S=t=>{t.preventDefault();const r=new FormData;r.append("title",s.title),r.append("description",s.description),r.append("start_date",s.start_date),s.end_date&&r.append("end_date",s.end_date),s.purok_ids.length>0&&s.purok_ids.forEach((c,p)=>{r.append(`purok_ids[${p}]`,c.toString())}),r.append("has_certificate",s.has_certificate?"1":"0"),r.append("target_all_residents",s.target_all_residents?"1":"0"),s.image&&r.append("image",s.image),r.append("_method","PUT"),k.post(route("partner.events.update",i.id),r,{forceFormData:!0})},F=t=>{var c;const r=(c=t.target.files)==null?void 0:c[0];if(r){d("image",r);const p=new FileReader;p.onload=I=>{var b;v((b=I.target)==null?void 0:b.result)},p.readAsDataURL(r)}},D=()=>{d("image",null),v(i.image_path?`/storage/${i.image_path}`:null),m.current&&(m.current.value="")},N=()=>{k.get(route("partner.events"))};return e.jsxs(e.Fragment,{children:[e.jsx(A,{title:"Edit Event"}),e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx("div",{className:"hidden lg:block",children:e.jsx(w,{currentPage:"partner.events"})}),_&&e.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>f(!1)}),e.jsx("div",{className:"absolute top-0 left-0 h-full",children:e.jsx(w,{currentPage:"partner.events"})})]}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx($,{userName:"Partner Agency",onMobileMenuToggle:()=>f(!_)}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:e.jsxs("div",{className:"mx-auto max-w-3xl space-y-6",children:[(n==null?void 0:n.success)&&e.jsx(C,{className:"border-green-200 bg-green-50",children:e.jsx(y,{className:"text-green-800",children:n.success})}),(n==null?void 0:n.error)&&e.jsx(C,{className:"border-red-200 bg-red-50",children:e.jsx(y,{className:"text-red-800",children:n.error})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(o,{variant:"outline",size:"sm",onClick:N,className:"gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),"Back"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Edit Event"}),e.jsx("p",{className:"text-gray-600",children:"Update event request details"})]})]}),e.jsxs(U,{children:[e.jsx(R,{children:e.jsx(L,{children:"Event Request Details"})}),e.jsx(B,{children:e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"title",children:"Event Title *"}),e.jsx(x,{id:"title",value:s.title,onChange:t=>d("title",t.target.value),placeholder:"Enter event title",className:a.title?"border-red-500":""}),a.title&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:a.title})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"description",children:"Description *"}),e.jsx(O,{id:"description",value:s.description,onChange:t=>d("description",t.target.value),placeholder:"Enter event description",rows:4,className:a.description?"border-red-500":""}),a.description&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:a.description})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"image",children:"Event Image"}),e.jsxs("div",{className:"space-y-4",children:[h&&e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:h,alt:"Event preview",className:"h-32 w-48 rounded-lg border object-cover"}),e.jsx(o,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2 h-6 w-6 rounded-full p-0",onClick:D,children:e.jsx(q,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(o,{type:"button",variant:"outline",className:"gap-2",onClick:()=>{var t;return(t=m.current)==null?void 0:t.click()},children:[e.jsx(z,{className:"h-4 w-4"}),h?"Change Image":"Upload Image"]}),e.jsx(x,{ref:m,type:"file",accept:"image/*",onChange:F,className:"hidden"}),e.jsx("span",{className:"text-sm text-gray-500",children:"JPG, PNG, GIF up to 2MB"})]})]}),a.image&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:a.image})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"start_date",children:"Start Date *"}),e.jsx(x,{id:"start_date",type:"datetime-local",value:s.start_date,onChange:t=>d("start_date",t.target.value),className:a.start_date?"border-red-500":""}),a.start_date&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:a.start_date})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"end_date",children:"End Date (Optional)"}),e.jsx(x,{id:"end_date",type:"datetime-local",value:s.end_date,onChange:t=>d("end_date",t.target.value),className:a.end_date?"border-red-500":""}),a.end_date&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:a.end_date})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"target_audience",children:"Target Audience"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"target_all_residents",checked:s.target_all_residents,onCheckedChange:t=>{d("target_all_residents",t),t&&d("purok_ids",[])}}),e.jsx(l,{htmlFor:"target_all_residents",className:"text-sm",children:"Target all residents"})]}),!s.target_all_residents&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Select Puroks (up to 3)"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:E.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:`purok_${t.id}`,checked:s.purok_ids.includes(t.id),onCheckedChange:r=>{r?s.purok_ids.length<3&&d("purok_ids",[...s.purok_ids,t.id]):d("purok_ids",s.purok_ids.filter(c=>c!==t.id))},disabled:!s.purok_ids.includes(t.id)&&s.purok_ids.length>=3}),e.jsx(l,{htmlFor:`purok_${t.id}`,className:"text-sm",children:t.name})]},t.id))}),s.purok_ids.length>=3&&e.jsx("p",{className:"mt-1 text-sm text-amber-600",children:"Maximum of 3 puroks can be selected"}),a.purok_ids&&e.jsx("p",{className:"text-sm text-red-600",children:a.purok_ids})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{id:"has_certificate",checked:s.has_certificate,onCheckedChange:t=>d("has_certificate",t)}),e.jsx(l,{htmlFor:"has_certificate",className:"text-sm",children:"This event will have certificates"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(o,{type:"button",variant:"outline",onClick:N,disabled:g,children:"Cancel"}),e.jsx(o,{type:"submit",disabled:g,children:g?"Updating...":"Update Event Request"})]})]})})]})]})})]})]})]})}export{xe as default};
