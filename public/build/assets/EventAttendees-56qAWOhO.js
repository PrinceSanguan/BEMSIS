import{K as A,r as m,j as e,L as _,S as M}from"./app-CMI4-wRO.js";import{A as f,a as u}from"./alert-CJ8GlPtT.js";import{B as D}from"./badge-DRu1kQMu.js";import{B as v}from"./button-CjgRfl2Z.js";import{C as i,b as c,c as n,a as d}from"./card-BMMac1pu.js";import{D as q,b as F,c as E,d as U}from"./dialog-LrRS0fHk.js";import B from"./Header-CuVDSu1a.js";import b from"./Sidebar-_Gwcflvj.js";import{A as P}from"./arrow-left-Dk3gdmnn.js";import{C as T}from"./circle-check-big-Df9E0GMW.js";import{C as L}from"./circle-x-CLadZy8w.js";import{C as $}from"./clock-CbVwXtzS.js";import{M as y}from"./map-pin-7ABLEzBR.js";import{U as C}from"./users-CGFr7jXR.js";import{M as z}from"./mail-BP2ilyUR.js";import{P as H}from"./phone-4Zxd9CjE.js";import{Q as I}from"./qr-code-BjihyYw7.js";import"./Combination-C7RuGcr_.js";import"./index-BKGyJec5.js";import"./dropdown-menu-Ceb6RPeA.js";import"./createLucideIcon-B7apOioz.js";import"./x-CTnFQMCX.js";import"./index-CtBsO7PD.js";import"./user-DvpxExd6.js";import"./log-out-B8rT_nil.js";import"./chart-column-BrD46wav.js";import"./calendar-ClpuGV6g.js";import"./file-text-BeZHVW_e.js";function ue({event:r,attendees:a}){const{flash:t}=A().props,[h,g]=m.useState(!1),[l,w]=m.useState(null),[R,j]=m.useState(!1),[p,k]=m.useState(null),o=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),Q=s=>{if(!s.qr_code){alert("No QR code assigned to this attendee");return}w(s);const S="https://api.qrserver.com/v1/create-qr-code/?"+new URLSearchParams({size:"200x200",data:s.qr_code,color:"000000",bgcolor:"FFFFFF",ecc:"M",margin:"10"});k(S),j(!0)},N=a.filter(s=>s.scanned).length,x=a.length>0?Math.round(N/a.length*100):0;return e.jsxs(e.Fragment,{children:[e.jsx(_,{title:`Attendees - ${r.title}`}),e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx("div",{className:"hidden lg:block",children:e.jsx(b,{currentPage:"secretary.events"})}),h&&e.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>g(!1)}),e.jsx("div",{className:"absolute top-0 left-0 h-full",children:e.jsx(b,{currentPage:"secretary.events"})})]}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx(B,{onMobileMenuToggle:()=>g(!h)}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:e.jsxs("div",{className:"mx-auto max-w-7xl space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(v,{variant:"outline",onClick:()=>M.get("/secretary/events"),className:"shrink-0",children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Back to Events"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r.title}),e.jsx("p",{className:"text-gray-600",children:"Event Attendees"})]})]}),(t==null?void 0:t.success)&&e.jsxs(f,{className:"border-green-200 bg-green-50",children:[e.jsx(T,{className:"h-4 w-4 text-green-600"}),e.jsx(u,{className:"text-green-800",children:t.success})]}),(t==null?void 0:t.error)&&e.jsxs(f,{className:"border-red-200 bg-red-50",children:[e.jsx(L,{className:"h-4 w-4 text-red-600"}),e.jsx(u,{className:"text-red-800",children:t.error})]}),e.jsxs(i,{children:[e.jsx(c,{children:e.jsx(n,{children:"Event Information"})}),e.jsxs(d,{children:[r.image_path&&e.jsx("div",{className:"mb-4",children:e.jsx("img",{src:`/storage/${r.image_path}`,alt:r.title,className:"h-48 w-full rounded-lg border object-cover"})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:[o(r.start_date),r.end_date&&` - ${o(r.end_date)}`]})]}),r.purok&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:r.purok.name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:[a.length," registered"]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("p",{className:"text-sm text-gray-600",children:r.description})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs(i,{children:[e.jsx(c,{className:"pb-2",children:e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Total Registered"})}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold",children:a.length})})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-2",children:e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Attended"})}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:N})})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-2",children:e.jsx(n,{className:"text-sm font-medium text-gray-600",children:"Attendance Rate"})}),e.jsx(d,{children:e.jsxs("div",{className:`text-2xl font-bold ${x>=80?"text-green-600":x>=60?"text-yellow-600":"text-red-600"}`,children:[x,"%"]})})]})]}),e.jsxs(i,{children:[e.jsx(c,{children:e.jsxs(n,{children:["Attendees (",a.length,")"]})}),e.jsx(d,{children:a.length===0?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(C,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No attendees"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"No one has registered for this event yet."})]}):e.jsx("div",{className:"space-y-4",children:a.map(s=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:s.user.name}),e.jsx(D,{className:s.scanned?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:s.scanned?"Attended":"Registered"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm text-gray-600 md:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),e.jsx("span",{children:s.user.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{children:s.user.phone})]}),s.user.purok&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx("span",{children:s.user.purok.name})]})]}),s.scanned&&s.scanned_at&&e.jsxs("div",{className:"mt-2 text-xs text-green-600",children:["Attended: ",o(s.scanned_at)]})]}),e.jsx("div",{className:"ml-4",children:s.qr_code&&e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>Q(s),children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),"View QR"]})})]},s.id))})})]})]})})]})]}),e.jsx(q,{open:R,onOpenChange:j,children:e.jsxs(F,{className:"max-w-md",children:[e.jsx(E,{children:e.jsxs(U,{children:["QR Code for ",l==null?void 0:l.user.name]})}),e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[p&&e.jsx("div",{className:"rounded-lg border bg-white p-4",children:e.jsx("img",{src:p,alt:"QR Code",className:"h-48 w-48",onError:s=>{console.error("Failed to load QR code image"),s.currentTarget.style.display="none"}})}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["QR Code: ",l==null?void 0:l.qr_code]}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"This QR code is used for attendance verification."})]})]})]})})]})}export{ue as default};
