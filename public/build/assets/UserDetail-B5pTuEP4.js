import{K,r as h,j as e,L as q,S as t}from"./app-CI-4VFax.js";import{A as w,a as C}from"./alert-C4gFx7ac.js";import{B as v}from"./badge-X1Y-1lsO.js";import{B as l}from"./button-DjP5DCua.js";import{C as d,b as o,c as m,a as x}from"./card-By9UBEhA.js";import G from"./Header-CQq9UpBd.js";import D from"./Sidebar-DhchyCDK.js";import{C as k}from"./circle-check-big-BYglXicT.js";import{C as S}from"./circle-x-DsPIyfSc.js";import{A as J}from"./arrow-left-BL2B-mnF.js";import{U as A}from"./user-check-CwxDfbnl.js";import{U as $}from"./user-x-DCfEDan_.js";import{U as Q}from"./user-CtEl8JKF.js";import{P as p}from"./phone-DKaBzIA7.js";import{M as U}from"./mail-DATOx-eA.js";import{M as W}from"./map-pin-D11Tmc_G.js";import{I as j}from"./id-card-kEZ2F0AV.js";import{E as P}from"./eye-BRYbbQtW.js";import{D as M}from"./download-Cgdxj4sP.js";import{B as Y}from"./building-2-BcwMGOnd.js";import{C as I}from"./calendar--sGQ-WuF.js";import"./dropdown-menu-xtMhRY4o.js";import"./createLucideIcon-BxQM5x_N.js";import"./Combination-CgmyZskN.js";import"./index-C0iWjysw.js";import"./index-CtBsO7PD.js";import"./log-out-Bc6-Y8uB.js";import"./chart-column-D3jKJw_X.js";import"./users-xRXBnnjG.js";import"./qr-code-Ca4C_Rzn.js";import"./file-text-BlCDcJL6.js";function Ue({user:s,className:Z}){const{flash:i}=K().props,[y,u]=h.useState(!1),[r,n]=h.useState(!1),[g,B]=h.useState(s);h.useEffect(()=>{const a=setInterval(async()=>{try{const c=await fetch(`/api/users/${s.id}/status`);if(c.ok){const _=await c.json();B(X=>({...X,is_online:_.is_online,last_seen_at:_.last_seen_at}))}}catch(c){console.error("Failed to fetch user status:",c)}},3e4);return()=>clearInterval(a)},[s.id]);const N=()=>{if(g.is_online)return{label:"Online",color:"bg-green-100 text-green-800",icon:"ðŸŸ¢"};{const a=g.last_seen_at?new Date(g.last_seen_at):null;return a?Math.floor((Date.now()-a.getTime())/6e4)<5?{label:"Recently Active",color:"bg-yellow-100 text-yellow-800",icon:"ðŸŸ¡"}:{label:"Offline",color:"bg-gray-100 text-gray-800",icon:"âš«"}:{label:"Offline",color:"bg-gray-100 text-gray-800",icon:"âš«"}}},E=()=>{n(!0),t.patch(`/secretary/users/${s.id}/approve`,{},{onFinish:()=>n(!1),onSuccess:()=>t.get("/secretary/users")})},z=()=>{n(!0),t.patch(`/secretary/users/${s.id}/decline`,{},{onFinish:()=>n(!1),onSuccess:()=>t.get("/secretary/users")})},O=()=>{n(!0),t.patch(`/secretary/users/${s.id}/activate`,{},{onFinish:()=>n(!1),onSuccess:()=>t.reload({only:["user"]})})},F=()=>{n(!0),t.patch(`/secretary/users/${s.id}/deactivate`,{},{onFinish:()=>n(!1),onSuccess:()=>t.reload({only:["user"]})})},R=a=>({resident:{label:"Resident",color:"bg-blue-100 text-blue-800"},partner_agency:{label:"Partner Agency",color:"bg-green-100 text-green-800"},secretary:{label:"Secretary",color:"bg-purple-100 text-purple-800"},captain:{label:"Captain",color:"bg-red-100 text-red-800"}})[a]||{label:a,color:"bg-gray-100 text-gray-800"},L=a=>({pending:{label:"Pending Review",color:"bg-yellow-100 text-yellow-800",icon:I},approved:{label:"Approved",color:"bg-green-100 text-green-800",icon:k},declined:{label:"Declined",color:"bg-red-100 text-red-800",icon:S}})[a]||{label:a,color:"bg-gray-100 text-gray-800",icon:I},V=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),T=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),b=R(s.role),f=L(s.status),H=f.icon;return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:`User Details - ${s.name}`}),e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx("div",{className:"hidden lg:block",children:e.jsx(D,{currentPage:"secretary.users"})}),y&&e.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>u(!1)}),e.jsx("div",{className:"absolute top-0 left-0 h-full",children:e.jsx(D,{currentPage:"secretary.users"})})]}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx(G,{onMobileMenuToggle:()=>u(!y)}),e.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"mx-auto max-w-4xl space-y-6",children:[(i==null?void 0:i.success)&&e.jsxs(w,{children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx(C,{children:i.success})]}),(i==null?void 0:i.error)&&e.jsxs(w,{variant:"destructive",children:[e.jsx(S,{className:"h-4 w-4"}),e.jsx(C,{children:i.error})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(l,{onClick:()=>t.get("/secretary/users"),variant:"outline",size:"sm",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Back to Users"]})}),e.jsx(d,{children:e.jsx(o,{children:e.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s.name}),e.jsx(v,{className:`px-3 py-1 text-sm font-medium ${b.color}`,children:b.label}),e.jsxs(v,{className:`px-3 py-1 text-sm font-medium ${f.color}`,children:[e.jsx(H,{className:"mr-1 h-3 w-3"}),f.label]}),e.jsxs(v,{className:`px-3 py-1 text-sm font-medium ${N().color}`,children:[e.jsx("span",{className:"mr-1",children:N().icon}),N().label]})]}),e.jsxs("p",{className:"text-gray-600",children:["Registered on ",V(s.created_at)]})]}),s.status==="pending"&&e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(l,{onClick:E,disabled:r,className:"bg-green-600 text-white hover:bg-green-700",children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),r?"Processing...":"Approve"]}),e.jsxs(l,{onClick:z,disabled:r,variant:"destructive",children:[e.jsx($,{className:"mr-2 h-4 w-4"}),r?"Processing...":"Decline"]})]}),s.status==="approved"&&e.jsx("div",{className:"flex gap-3",children:s.is_active?e.jsxs(l,{onClick:F,disabled:r,variant:"outline",className:"border-red-300 text-red-600 hover:border-red-400 hover:text-red-700",children:[e.jsx($,{className:"mr-2 h-4 w-4"}),r?"Processing...":"Deactivate Account"]}):e.jsxs(l,{onClick:O,disabled:r,variant:"outline",className:"border-green-300 text-green-600 hover:border-green-400 hover:text-green-700",children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),r?"Processing...":"Activate Account"]})})]})})}),s.role==="resident"?e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(d,{children:[e.jsx(o,{children:e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5"}),"Personal Information"]})}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Full Name:"}),e.jsx("p",{className:"mt-1",children:`${s.first_name||""} ${s.middle_name||""} ${s.last_name||""} ${s.extension||""}`.trim()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Date of Birth:"}),e.jsx("p",{className:"mt-1",children:s.date_of_birth?T(s.date_of_birth):"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Age:"}),e.jsx("p",{className:"mt-1",children:s.age||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Sex:"}),e.jsx("p",{className:"mt-1",children:s.sex||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Civil Status:"}),e.jsx("p",{className:"mt-1",children:s.civil_status||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Place of Birth:"}),e.jsx("p",{className:"mt-1",children:s.place_of_birth||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Citizenship:"}),e.jsx("p",{className:"mt-1",children:s.citizenship||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Occupation:"}),e.jsx("p",{className:"mt-1",children:s.occupation||"Not provided"})]}),s.special_notes&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Special Notes:"}),e.jsx("p",{className:"mt-1",children:s.special_notes})]})]})})]}),e.jsxs(d,{children:[e.jsx(o,{children:e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-5 w-5"}),"Contact & Location"]})}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Email:"}),e.jsx("p",{className:"mt-1",children:s.email})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Contact Number:"}),e.jsx("p",{className:"mt-1",children:s.contact_number||s.phone})]})]}),s.purok&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Purok:"}),e.jsx("p",{className:"mt-1",children:s.purok.name})]})]})]})})]}),s.valid_id_path&&e.jsxs(d,{className:"lg:col-span-2",children:[e.jsx(o,{children:e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-5 w-5"}),"Uploaded Documents"]})}),e.jsx(x,{children:e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(j,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Valid ID"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Uploaded identification document"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{onClick:()=>window.open(`/storage/${s.valid_id_path}`,"_blank"),variant:"outline",size:"sm",children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"View"]}),e.jsxs(l,{onClick:()=>{const a=document.createElement("a");a.href=`/storage/${s.valid_id_path}`,a.download=`valid_id_${s.name}`,a.click()},variant:"outline",size:"sm",children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),"Download"]})]})]})})})})]})]}):e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(d,{children:[e.jsx(o,{children:e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5"}),"Agency Information"]})}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Agency Name:"}),e.jsx("p",{className:"mt-1",children:s.agency_name||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Representative:"}),e.jsx("p",{className:"mt-1",children:`${s.representative_first_name||""} ${s.representative_last_name||""}`.trim()||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Agency Address:"}),e.jsx("p",{className:"mt-1",children:s.agency_address||"Not provided"})]})]})})]}),e.jsxs(d,{children:[e.jsx(o,{children:e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-5 w-5"}),"Contact Information"]})}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Email:"}),e.jsx("p",{className:"mt-1",children:s.email})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Agency Contact:"}),e.jsx("p",{className:"mt-1",children:s.agency_contact_number||s.phone})]})]})]})})]}),s.agency_valid_id_path&&e.jsxs(d,{className:"lg:col-span-2",children:[e.jsx(o,{children:e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-5 w-5"}),"Uploaded Documents"]})}),e.jsx(x,{children:e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(j,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Agency Documents"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Valid ID or Official Agency Endorsement"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{onClick:()=>window.open(`/storage/${s.agency_valid_id_path}`,"_blank"),variant:"outline",size:"sm",children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"View"]}),e.jsxs(l,{onClick:()=>{const a=document.createElement("a");a.href=`/storage/${s.agency_valid_id_path}`,a.download=`agency_documents_${s.agency_name}`,a.click()},variant:"outline",size:"sm",children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),"Download"]})]})]})})})})]})]})]})})]})]})]})}export{Ue as default};
