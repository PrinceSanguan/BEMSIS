import{K as A,r as h,m as U,j as e,L as R,S as C}from"./app-B1Wi4E-8.js";import{A as S,a as w}from"./alert-Dx-Is7v8.js";import{B as c}from"./button-DbPNcHHT.js";import{C as L,b as B,c as O,a as q}from"./card-BPVvoLsA.js";import{C as y}from"./checkbox-BInxlpjk.js";import{I as m}from"./input-5xl38F00.js";import{L as d}from"./label-DvsMo31S.js";import{S as z,a as G,b as M,c as H,d as V}from"./select-BVUfwicO.js";import{T as $}from"./textarea-CCppvqVp.js";import J from"./Header-CHRRBs1i.js";import E from"./Sidebar-Dk9KvFCF.js";import{A as K}from"./arrow-left-BLoyKF_O.js";import{X}from"./x-B5vf4ySl.js";import{U as Q}from"./upload-BzkUfoMy.js";import"./Combination-eUq_mQI_.js";import"./index-D0cdTG85.js";import"./index-DI8FJpjl.js";import"./createLucideIcon-Dto5OKXk.js";import"./dropdown-menu-jebMUTZ7.js";import"./index-CtBsO7PD.js";import"./user-B_mYxzfm.js";import"./log-out-CYmKAFhs.js";import"./chart-column-DByp3CUK.js";import"./calendar-qxz_CE0J.js";function Ne({event:r,puroks:F}){var f,v;const{flash:n}=A().props,[g,j]=h.useState(!1),[p,u]=h.useState(r.image_path?`/storage/${r.image_path}`:null),o=h.useRef(null),{data:a,setData:l,processing:x,errors:s}=U({title:r.title,description:r.description,start_date:r.start_date?new Date(r.start_date).toISOString().slice(0,16):"",end_date:r.end_date?new Date(r.end_date).toISOString().slice(0,16):"",purok_id:((v=(f=r.purok)==null?void 0:f.id)==null?void 0:v.toString())||"",has_certificate:r.has_certificate,target_all_residents:r.target_all_residents,image:null}),D=t=>{t.preventDefault();const i=new FormData;i.append("title",a.title),i.append("description",a.description),i.append("start_date",a.start_date),a.end_date&&i.append("end_date",a.end_date),a.purok_id&&i.append("purok_id",a.purok_id),i.append("has_certificate",a.has_certificate?"1":"0"),i.append("target_all_residents",a.target_all_residents?"1":"0"),a.image&&i.append("image",a.image),i.append("_method","PUT"),C.post(route("partner.events.update",r.id),i,{forceFormData:!0})},I=t=>{var N;const i=(N=t.target.files)==null?void 0:N[0];if(i){l("image",i);const b=new FileReader;b.onload=P=>{var k;u((k=P.target)==null?void 0:k.result)},b.readAsDataURL(i)}},T=()=>{l("image",null),u(r.image_path?`/storage/${r.image_path}`:null),o.current&&(o.current.value="")},_=()=>{C.get(route("partner.events"))};return e.jsxs(e.Fragment,{children:[e.jsx(R,{title:"Edit Event"}),e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx("div",{className:"hidden lg:block",children:e.jsx(E,{currentPage:"partner.events"})}),g&&e.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>j(!1)}),e.jsx("div",{className:"absolute top-0 left-0 h-full",children:e.jsx(E,{currentPage:"partner.events"})})]}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx(J,{userName:"Partner Agency",onMobileMenuToggle:()=>j(!g)}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:e.jsxs("div",{className:"mx-auto max-w-3xl space-y-6",children:[(n==null?void 0:n.success)&&e.jsx(S,{className:"border-green-200 bg-green-50",children:e.jsx(w,{className:"text-green-800",children:n.success})}),(n==null?void 0:n.error)&&e.jsx(S,{className:"border-red-200 bg-red-50",children:e.jsx(w,{className:"text-red-800",children:n.error})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:_,className:"gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),"Back"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Edit Event"}),e.jsx("p",{className:"text-gray-600",children:"Update event request details"})]})]}),e.jsxs(L,{children:[e.jsx(B,{children:e.jsx(O,{children:"Event Request Details"})}),e.jsx(q,{children:e.jsxs("form",{onSubmit:D,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"title",children:"Event Title *"}),e.jsx(m,{id:"title",value:a.title,onChange:t=>l("title",t.target.value),placeholder:"Enter event title",className:s.title?"border-red-500":""}),s.title&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.title})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"description",children:"Description *"}),e.jsx($,{id:"description",value:a.description,onChange:t=>l("description",t.target.value),placeholder:"Enter event description",rows:4,className:s.description?"border-red-500":""}),s.description&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.description})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"image",children:"Event Image"}),e.jsxs("div",{className:"space-y-4",children:[p&&e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:p,alt:"Event preview",className:"h-32 w-48 rounded-lg border object-cover"}),e.jsx(c,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2 h-6 w-6 rounded-full p-0",onClick:T,children:e.jsx(X,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(c,{type:"button",variant:"outline",className:"gap-2",onClick:()=>{var t;return(t=o.current)==null?void 0:t.click()},children:[e.jsx(Q,{className:"h-4 w-4"}),p?"Change Image":"Upload Image"]}),e.jsx(m,{ref:o,type:"file",accept:"image/*",onChange:I,className:"hidden"}),e.jsx("span",{className:"text-sm text-gray-500",children:"JPG, PNG, GIF up to 2MB"})]})]}),s.image&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.image})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"start_date",children:"Start Date *"}),e.jsx(m,{id:"start_date",type:"datetime-local",value:a.start_date,onChange:t=>l("start_date",t.target.value),className:s.start_date?"border-red-500":""}),s.start_date&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.start_date})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"end_date",children:"End Date (Optional)"}),e.jsx(m,{id:"end_date",type:"datetime-local",value:a.end_date,onChange:t=>l("end_date",t.target.value),className:s.end_date?"border-red-500":""}),s.end_date&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.end_date})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"target_audience",children:"Target Audience"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{id:"target_all_residents",checked:a.target_all_residents,onCheckedChange:t=>{l("target_all_residents",t),t&&l("purok_id","")}}),e.jsx(d,{htmlFor:"target_all_residents",className:"text-sm",children:"Target all residents"})]}),!a.target_all_residents&&e.jsxs("div",{children:[e.jsx(d,{htmlFor:"purok_id",children:"Select Purok"}),e.jsxs(z,{value:a.purok_id,onValueChange:t=>l("purok_id",t),children:[e.jsx(G,{className:s.purok_id?"border-red-500":"",children:e.jsx(M,{placeholder:"Select a purok"})}),e.jsx(H,{children:F.map(t=>e.jsx(V,{value:t.id.toString(),children:t.name},t.id))})]}),s.purok_id&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.purok_id})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{id:"has_certificate",checked:a.has_certificate,onCheckedChange:t=>l("has_certificate",t)}),e.jsx(d,{htmlFor:"has_certificate",className:"text-sm",children:"This event will have certificates"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(c,{type:"button",variant:"outline",onClick:_,disabled:x,children:"Cancel"}),e.jsx(c,{type:"submit",disabled:x,children:x?"Updating...":"Update Event Request"})]})]})})]})]})})]})]})]})}export{Ne as default};
